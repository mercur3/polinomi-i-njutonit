\documentclass[12pt, margin=1in, a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage{indentfirst}
\usepackage[ddmmyyyy]{datetime}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{amsmath}


\renewcommand{\dateseparator}{.}
\renewcommand{\contentsname}{Permbajtja}
\lstloadlanguages{Octave}
\lstset{
  basicstyle=\ttfamily\small,
  language=Octave,
  numbers=left,
  breaklines=true,
  showstringspaces=false,
  columns=flexible,
  keepspaces=true,
  commentstyle=\color{green},
  stringstyle=\color{brown},
  numberstyle=\color{burgundy},
  keywordstyle=\color{blue}
}

\title{Polinomi interpolues i Njutonit me diferenca t:e prapme}
\author{
    Andri Reveli - \href{mailto:andri.reveli@fshnstudent.info}{\texttt{andri.reveli@fshnstudent.info}}
    \and
    Anxhela Kamberaj - \href{mailto:anxhela.kamberaj@fshnstudent.info}{\texttt{anxhela.kamberaj@fshnstudent.info}}
    \and
    Naile Mucaj - \href{mailto:naile.mucaj@fshnstudent.info}{\texttt{naile.mucaj@fshnstudent.info}}
    \and
}

\begin{document}
\tableofcontents

\newpage

\section{Hyrje}
  \subsection{Polinomi interpolues i Njutonit}
  Polinomi interpolues i Njutonit :esht:e nj:e metod:e p:er interpolimin e
  funksioneve t:e dh:en:e midis 2 pikave t:e caktuara. Ne form:en e p:ergjith:esuar ai
  shprehet si:
  \begin{equation}\label{eq:newton}
  \begin{aligned}
    P(x) &= f(x_0) + (x - x_0)f[x_0, \ x_1] + \ \dots \\
    &+ (x - x_0)(x - x_1) \ \dots (x - x_{n - 1})f[x_0, \ x_1, \ \dots, \ x_n]
  \end{aligned}
  \end{equation}

  P:er ta b:er:e formul:en me te qart:e mund ta shkruajm:e si:
  \[
    P(x) = f(x_0) + \sum_{i = 1}^{n}{\prod_{j = 0}^{i - 1}{(x - x_j)}f[x_0, \ \dots, \ x_i]} \\
  \]

  Dhe gabimi jepet nga formula:
  \[
    E(x) = f[x_0, \ x_1, \ \dots, \ x_n]\prod_{i = 0}^n{(x - x_i)}
  \]

  \subsection{Diferencat e ndara}
  Supozojm:e se largesa midis pikave \(x_0, \ x_1, \ \dots, \ x_n\) :esht:e e
  barabart:e. P:er rrjedhoj:e, mund te shkruajm:e:
  \[
    h = x_i - x_{i - i}, \ i = 1, \ 2, \ \dots, \ n
  \]

  Ne k:eto kushte diferenc:e e fundme e prapme e rendit t:e par:e quajm:e:
  \(\nabla y_i = y_i - y_{i - 1}\), kurse diferenc:e t:e fundme t:e rendit \(n\):
  \(\nabla^ny_i = \nabla(\nabla^{n - 1}y_i)\).

  \subsection{Polinomi interpolues me diferenca t:e ndara}
  Duke z:evendesuar nga polinomi i Njutonit (\ref{eq:newton}) diferenca e ndara me
  ato t:e fundme t:e prapme marrim:
  \begin{equation}
  \begin{aligned}
    P_n(x) &= f(x_n) + \nabla f(x_n)\frac{x - x_n}{h} + \nabla^2f(x_n)\frac{(x - x_n)(x - x_{n - 1})}{2 \cdot h!} \\
    &+ \dots + \nabla^n f(x_n)\frac{(x - x_n)(x - x_{n - 1}) \dots (x - x_1)}{n! \cdot h^n}
  \end{aligned}
  \end{equation}

  Duke shkruar \(q = \frac{x - x_0}{h}\), marrim:
  \begin{equation}
  \begin{aligned}
    P_n(x) &= y_n + q\nabla y_n + \frac{q(q + 1)}{2!}\nabla^2y_n + \ \dots \ + \frac{q(q + 1)\dots(q + n - 1)}{n!}\nabla^n y_n \\
    &= y_n + \sum_{i = 1}^n{\frac{\prod_{j = 0}^{i - 1}{(q + j)}}{i!}\nabla^iy_n}
  \end{aligned}
  \end{equation}

  Gabimi i trungezimit nd:erkoh:e jepet nga:
  \begin{equation}
    E_n(x) = q(q + 1) \cdots (q + n)\frac{\nabla^{n + 1}f(x_n)}{(n + 1)!}
  \end{equation}

  Polinomi interpolues me diferenca t:e prapme performon m:e mir:e n:e rastin
  kur pika q:e jepet :esht:e m:e pran:e skajit t:e djatht:e.

  \newpage

\section{Zbatime}
  Marrim funksionin e p:ercatkuar si m:e posht:e:
  \begin{table*}[ht]
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    \(x\) & 10 & 20 & 30 & 40 \\
    \hline
    \(f(x)\) & 0.174 & 0.347 & 0.518 & 0.627 \\
    \hline
  \end{tabular}
  \end{table*}

  Nd:ertojm:e tabel:en e diferencave t:e fundme t:e prapme:
  \begin{table*}[ht]
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    \(x_i\) & \(y_i\) & \(\nabla y_i\) & \(\nabla^2y_i\) & \(\nabla^3y_i\) \\
    \hline
    10 & 0.174 & & & \\
    \hline
    20 & 0.347 & 0.173 & & \\
    \hline
    30 & 0.518 & 0.171 & -0.002 & \\
    \hline
    40 & 0.627 & 0.109 & -0.062 & -0.06 \\
    \hline
  \end{tabular}
  \end{table*}

  Nga kjo marrim polinomin interpolues me:
  \begin{equation}
    q = \frac{x - x_3}{h} = \frac{x - 40}{10} = -2.9
  \end{equation}

  \begin{equation}
  \begin{aligned}
    P_2(11) &= y_3 + x\nabla y_3 + \frac{q(q + 1)}{2}\nabla^2y_3 \\
    &= 0.627 + \frac{0.109(x - 40)}{10} + \frac{-0.062 \cdot \frac{x - 40}{10} \cdot \frac{x - 30}{10}}{2} \\
    &= 0.14009
  \end{aligned}
  \end{equation}

  Gabimi:
  \begin{equation}
  \begin{aligned}
    E_2(11) &= \frac{q(q + 1)(q + 2)}{3!}\nabla^3y_3 \\
    &= \frac{-2.9 \cdot (-1.9) \cdot (-0.9) \cdot (-0.06)}{3!} = 0.04959
  \end{aligned}
  \end{equation}

  \newpage

\section{Algoritmi ne Octave}
  \begin{lstlisting}
  function newton(vec_x, vec_y, x)
    n = length(vec_x)
    q = (x - vec_x(n)) / (vec_x(2) - vec_x(1))
    diff_prapme = vec_y(1:n);
    nabla = zeros(n - 1);
    val = vec_y(n)
  
    for i = 1:n - 1
      % llogarit diferencat e prapme
      for j = n:-1:i+1
        diff_prapme(j) -= diff_prapme(j - 1);
      endfor
      nabla(i) = diff_prapme(n);
  
      % printo diferencat e prapme
      printf("Diferenca e rendit %d: ", i);
      for j = i + 1:n
        printf("%f ", diff_prapme(j));
      endfor
      printf("\nNabla %d: %f\n", i, nabla(i));
    endfor
  
    % interpolimi
    for i = 1:n - 2
      num = q;
      em = factorial(i);
      for j = 1:i - 1
        num *= (q + j);
      endfor

      val += nabla(i) * num / em;
    endfor
  
    printf("Vlera = %f\n", val);
  
    c = polyfit(vec_x, vec_y, n - 1);
    z = [vec_x(1):(vec_x(n) - vec_x(1)) / 100:vec_x(n)];
    p = polyval(c, z);
    plot(z, p, vec_x, vec_y, 'o')
  endfunction
  \end{lstlisting}
  \newpage

\section{Literatura}
\begin{enumerate}
  \item Hoxha.F, Metoda të Analizës Numerike, Infobotues, Tiranë, 2008
\end{enumerate}
\end{document}

